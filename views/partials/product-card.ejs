<%
  // Product card partial - clickable card that opens modal
  const outOfStock = product.quantity <= 0;
  const lowStock = product.quantity > 0 && product.quantity < 10;
  const hasImage = product.image && product.image !== '';
  const imageSrc = hasImage ? `/images/${product.image}` : '/images/misc/no-image.svg';
  
  // Stock badge color
  let stockColor = '';
  let stockText = '';
  if (outOfStock) {
    stockColor = 'bg-danger';
    stockText = 'Out of Stock';
  } else if (lowStock) {
    stockColor = 'bg-warning';
    stockText = `Only ${product.quantity} left`;
  }
%>

<div class="card product-card h-100" style="cursor:pointer;" onclick="openProductModal(<%= product.id %>)" data-product-id="<%= product.id %>">
  <div class="position-relative">
    <img src="<%= imageSrc %>" 
         class="card-img-top" 
         alt="<%= product.productName %>" 
         style="height:180px;object-fit:cover;"
         onerror="this.src='/images/misc/no-image.svg'">
    
    <% if (product.deal) { %>
      <span class="badge bg-danger position-absolute top-0 end-0 m-2">DEAL!</span>
    <% } %>
    
    <% if (product.featured) { %>
      <span class="badge bg-warning position-absolute top-0 start-0 m-2">Featured</span>
    <% } %>
    
    <% if (stockColor) { %>
      <span class="badge <%= stockColor %> position-absolute bottom-0 start-50 translate-middle-x mb-2"><%= stockText %></span>
    <% } %>
  </div>
  
  <div class="card-body d-flex flex-column">
    <h6 class="card-title mb-1"><%= product.productName %></h6>
    <% if (product.brand) { %>
      <small class="text-muted"><%= product.brand %></small>
    <% } %>
    <p class="fw-bold mt-auto mb-0">$<%= (product.price || 0).toFixed(2) %></p>
    
    <%  if (product.category) { %>
      <small class="badge bg-secondary mt-1"><%= product.category %></small>
    <% } %>
  </div>
</div>

<style>
.product-card {
  transition: transform 0.2s, box-shadow 0.2s;
}
.product-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}
</style>
